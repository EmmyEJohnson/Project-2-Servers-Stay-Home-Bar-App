<!-- USERS index.ejs -->
<header>
  <%- include('../partials/header.ejs') %>
  </header>
<!-- When user goes through Google OAuth and is now admitted into the bar of choice -->
<html lang="en">
  
    <nav class="userNav"> 
        <ul>
          <li><a href="/" id="home">Home</a></li>
          <li>
            <% if (users) { %>
            <a href="/logout" id="userLogout"
              ><i class="material-icons left"></i>Log Out</a
            >
            <% } else { %>
            <a href="/auth/google"
              ><i class="material-icons left">vpn_key</i>Login with Google</a
            >
            <% } %>
          </li>
        </ul> 
    </nav>
 
<div id="users">
    <% users.forEach(function(user) { %>
        <div>
          <span class="title">
            <i><b> Profile: </b></i><br><br>
            <span class="user-name"> <%= user.name %> </span><br><br>
            <span class="user-photo"><img src="<%= user.photo %>" alt="Profile Picture"></span><br><br>
            <% if (user.barChoice) { %><span class="badge white"
              >Bar <%= user.barChoice %></span><% } %>
          </span><br><br>
        </div>
        <ul class="comments">
          <% user.comments.forEach(function(comment) { %>
          <li class="collection-item blue-grey-text text-darken-2">
            <%= comment.text %>
            <%= comment.id %>
            <%= comment._id %>
            <%= comment.drink %>
          </li>
          <% if (user._id.equals(currentUser._id)) { %>
          <form action="/comments/<%= comment._id %>?_method=DELETE" method="POST" id="delete-comment">
            <button type="delete" class="btn white-text"  id="delCommentBtn">Delete Comment</button>
        </form>
        <% } %>
          <% }) %>
        </ul>

        <% if (user._id.equals(currentUser._id)) { %>
          <div class="newComment">
            <form action="/users/<%= user._id %>" method="POST">
              <input type="text" name="text" id="text" value="Message..."
              onblur="if(this.value==''){ this.value='Message...'; this.style.color='#BBB';}"
              onfocus="if(this.value=='Message...'){ this.value=''; this.style.color='#000';}"
              style="color:#BBB;" />
              <select name="drink" id="drink">
                <option value=" ||  I'm fueled on sheer force of air and anger alone"></option>
                <option value=" ||  Currently Drinking: Beer"> Beer </option>
                <option value=" ||  Currently Drinking: Wine"> Wine </option>
                <option value=" ||  Currently Drinking: Whiskey"> Whiskey </option>
                <option value=" ||  Currently Drinking: Brandy"> Brandy </option>
                <option value=" ||  Currently Drinking: Vodka"> Vodka </option>
                <option value=" ||  Currently Drinking: Water"> Water </option>
              </select>
              <button type="submit" class="btn white-text" id="addCommentBtn">Add Comment</button>
            </form>
            <!-- <button type="delete" class="btn white-text" method="DELETE" id="delCommentBtn">Delete Comment</button> -->
        </div>
        <% } %>
        <!-- Split up the form actions so they are able to  -->
    <% }) %>
  </div>
  </html>

  <footer>
    <%- include('../partials/footer.ejs') %>
    </footer>